<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
</head>
<body>
<div class="container mt-5">
    <h1>Hello, world!</h1>
    <form>
        <div class="form-row">
            <div class="col">
               <input id="contracts-list" type="text" class="form-control" placeholder="enter ct-102"/>
            </div>
            <div class="col">
                <button id="notify" type="button" class="btn btn-secondary form-control font-weight-bold">
                    Notify Me?? </button>
            </div>

        </div>
    </form>

    <table class="table mt-5">
            <thead class="thead-dark">
            <tr>
                <th scope="col">Id</th>
                <th scope="col">contract Id</th>
                <th scope="col">original Amount</th>
                <th scope="col">amount Due</th>
                <th scope="col">interest paid</th>
                <th scope="col">clients no</th>
            </tr>
            </thead>
        <tbody id="table-body">

        </tbody>
    </table>
</div>

<script type="text/javascript">
    const observeContracts = () => {
        const contractId = document.getElementById('contracts-list').value;
        const tBody = document.getElementById('table-body');

        var source =new EventSource("/contractsController/" + contractId);
        alert('below source contractId ' + contractId);
        source.onmessage = (evt) => {
            let contract = JSON.parse(evt.data);

            let row = `
                <th scope="row">${contract.id}</th>
				      <td>${contract.contractId}</td>
				      <td>${contract.originalAmount}</td>
				      <td>${contract.amountDue}</td>
				      <td>${contract.interestPaid}</td>
				      <td>${contract.clients}</td>
				      `;

				      let tr = document.createElement('tr');
				        tr.innerHTML = row;
				        tBody.appendChild(tr);
        };
        // above is callback
    }

    document.getElementById('notify').addEventListener('click', observeContracts);

</script>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.6.1.slim.min.js"
        ></script>


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
        integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
        crossorigin="anonymous"></script>

</body>
</html>
